mini.TreeGrid=function(){this.columns=[],mini.TreeGrid.superclass.constructor.call(this)},mini.extend(mini.TreeGrid,mini.Tree,{width:300,height:180,EL:"",columns:[],Xr:80,_borderCls:"mini-treegrid-border",_headerCls:"mini-treegrid-header",_bodyCls:"mini-treegrid-body",_nodeCls:"mini-treegrid-node",_nodesCls:"mini-treegrid-nodes",_selectedNodeCls:"mini-treegrid-selectedNode",_nodeHoverCls:"mini-treegrid-hoverNode",_expandNodeCls:"mini-treegrid-expand",_collapseNodeCls:"mini-treegrid-collapse",_eciconCls:"mini-treegrid-ec-icon",_inNodeCls:"mini-treegrid-nodeTitle",_getNodeHoverEl:function(a){if(!a)return null;var b=this._getNodeTitleEl(a);return b},uiCls:"mini-treegrid",_create:function(){mini.TreeGrid.superclass._create.call(this),_p(this.bodyEl,"scroll",this.Dri,this)},JDS:function(){var c,d,e,f,g,a=this.getColumns(),b=[];for(b[b.length]='<div class="mini-treegrid-headerInner"><table class="mini-treegrid-table" cellspacing="0" cellpadding="0"><tr>',c=0,d=a.length;d>c;c++)e=a[c],f=e.header,mini.isNull(f)&&(f="&nbsp;"),g=e.width,mini.isNumber(g)&&(g+="px"),b[b.length]='<td class="',e.headerCls&&(b[b.length]=e.headerCls),b[b.length]='" style="',e.headerStyle&&(b[b.length]=e.headerStyle+";"),g&&(b[b.length]="width:"+g+";"),e.headerAlign&&(b[b.length]="text-align:"+e.headerAlign+";"),b[b.length]='">',b[b.length]=f,b[b.length]="</td>";b[b.length]="</tr></table></div>",this.headerEl.innerHTML=b.join("")},Z5J:function(a){var c,e,f,g,h,i,j,k,l,m,b=a[this.textField];for((null===b||void 0===b)&&(b=""),c=this.isLeaf(a),this.getLevel(a),e="",c||(e=this.isExpandedNode(a)?this._expandNodeCls:this._collapseNodeCls),f=this.getColumns(),g=[],g[g.length]='<table class="mini-treegrid-nodeTitle '+e+'" cellspacing="0" cellpadding="0"><tr>',h=0,i=f.length;i>h;h++)j=f[h],k=this._OnDrawCell(a,j),l=j.width,"number"==typeof l&&(l+="px"),g[g.length]='<td class="',k.cellCls&&(g[g.length]=k.cellCls),g[g.length]='" style="',k.cellStyle&&(g[g.length]=k.cellStyle+";"),l&&(g[g.length]="width:"+l+";"),j.align&&(g[g.length]="text-align:"+j.align+";"),g[g.length]='">',g[g.length]=k.cellHtml,g[g.length]="</td>",k.rowCls&&(rowCls=k.rowCls),k.rowStyle&&(rowStyle=k.rowStyle);return g[g.length]="</table>",m=g.join("")},doUpdate:function(){if(this.allowUpdate){this.JDS();var a=this.root[this.nodesField],b=this.QRG(a,this.root);this.bodyEl.innerHTML=b,this.doLayout()}},doLayout:function(){if(this.canLayout()){var c=(this.isAutoHeight(),this.isAutoWidth(),this.getWidth(!0)),d=this.getHeight(!0),e=this.getHeaderHeight(),f=d-e;this.bodyEl.style.width=c+"px",this.bodyEl.style.height=f+"px",this.Qoz()}},Qoz:function(){var b,c,d,a=this.getWidth(!0);mini.isIE&&(b=this.headerEl.firstChild.firstChild,c=this.bodyEl.firstChild,this.bodyEl.offsetHeight>=this.bodyEl.scrollHeight?(c.style.width="100%",b&&(b.style.width="100%")):(d=parseInt(c.parentNode.offsetWidth-17)+"px",c.style.width=d,b&&(b.style.width=d))),this.headerEl.firstChild.style.width=this.bodyEl.offsetHeight<this.bodyEl.scrollHeight?a-17+"px":"100%"},getHeaderHeight:function(){return RK(this.headerEl)},_OnDrawCell:function(a,b){var d,e,f,c=this.LF;return c&&this.hasChildren(a)&&(c=this.AT),d=a[b.field],e={isLeaf:this.isLeaf(a),rowIndex:this.indexOf(a),showCheckBox:c,iconCls:this.getNodeIcon(a),showTreeIcon:this.Je,sender:this,record:a,node:a,column:b,field:b?b.field:null,value:d,cellHtml:d,rowCls:null,cellCls:b?b.cellCls||"":"",rowStyle:null,cellStyle:b?b.cellStyle||"":""},b.dateFormat&&(e.cellHtml=mini.isDate(e.value)?mini.formatDate(d,b.dateFormat):d),f=b.renderer,f&&(fn="function"==typeof f?f:window[f],fn&&(e.cellHtml=fn.call(b,e))),this.fire("drawcell",e),(null===e.cellHtml||void 0===e.cellHtml||""===e.cellHtml)&&(e.cellHtml="&nbsp;"),this.EL&&this.EL===b.name?(this.IYO(e),e):e},IYO:function(a){var c,d,e,f,g,h,i,b=a.node;mini.isNull(a.showTreeIcon)&&(a.showTreeIcon=this.Je),c=a.cellHtml,d=this.isLeaf(b),e=18*this.getLevel(b),f="",a.cellCls?a.cellCls+=" mini-treegrid-treecolumn ":a.cellCls=" mini-treegrid-treecolumn ",g='<div class="mini-treegrid-treecolumn-inner '+f+'">',d||(g+='<a href="#" onclick="return false;"  hidefocus class="'+this._eciconCls+'" style="left:'+e+'px;"></a>'),e+=18,a.showTreeIcon&&(h=this.getNodeIcon(b),g+='<div class="'+h+' mini-treegrid-nodeicon" style="left:'+e+'px;"></div>',e+=18),c='<span class="mini-tree-nodetext">'+c+"</span>",a.showCheckBox&&(i=this.Os9(b),c='<input type="checkbox" id="'+i+'" class="'+this._checkBoxCls+'" hidefocus />'+c),g+='<div class="mini-treegrid-nodeshow" style="margin-left:'+(e+2)+'px;">'+c+"</div>",g+="</div>",c=g,a.cellHtml=c},setColumns:function(a){var b,c,d,e,f,g;for(mini.isArray(a)||(a=[]),this.columns=a,b=0,c=this.columns.length;c>b;b++)d=this.columns[b],d.type&&(mini.isNull(d.header)||"function"==typeof d.header||""==d.header.trim()&&delete d.header,e=mini._getColumn(d.type),e&&(f=mini.copyTo({},d),mini.copyTo(d,e),mini.copyTo(d,f))),g=parseInt(d.width),mini.isNumber(g)&&String(g)==d.width&&(d.width=g+"px"),mini.isNull(d.width)&&(d.width=this.Xr+"px");this.doUpdate()},getColumns:function(){return this.columns},getBottomColumns:function(){return this.columns},setTreeColumn:function(a){this.EL!=a&&(this.EL=a,this.doUpdate())},getTreeColumn:function(){return this.EL},Dri:function(){var b=this.bodyEl.scrollLeft;this.headerEl.firstChild.scrollLeft=b},getAttrs:function(a){var c,d,e,f,g,b=mini.TreeGrid.superclass.getAttrs.call(this,a);for(mini._ParseString(a,b,["treeColumn","ondrawcell"]),c=mini.getChildNodes(a),d=0,e=c.length;e>d;d++)f=c[d],g=jQuery(f).attr("property"),g&&(g=g.toLowerCase(),"columns"==g&&(b.columns=mini._ParseColumns(f)));return delete b.data,b}}),mini.regClass(mini.TreeGrid,"treegrid");